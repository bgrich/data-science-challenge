---
title: "Summary"
output: 
  html_notebook:
    toc: true
    toc_float: true
---

The primary question of the Room Key Data Challenge was:

> What factors correlate with users booking and in turn, what can Room Key do 
> to increase booking conversion rate?

The work that I did is contained in the following notebooks: 

* [Data Details](Data_Details.nb.html) 
* [Exploratory Data Analysis](Exploratory_Data_Analysis.nb.html) 
* [Variable Importance via Random Forest](Variable_Importance_RF.nb.html)

In the Data Details notebook, I worked through importing and cleaning the data 
and I did some initial exploration of the data to get a sense of what each 
variable contained. The Exploratory Data Analysis notebook digs deeper into 
each variable in the data set and attempts to either visualize or calculate 
trends in the data. The notebook on Variable Importance via Random Forest 
details an exploration of different ways to train a random forest model to 
determine what variables correlate with users booking. 

The bulk of the work was done in the Exploratory Data Analysis and Variable 
Importance via Random Forest notebooks. This notebook will contain a summary 
of my work, highlighting the key results. For my information on my process and 
all of the steps taken to reach these results, please see the individual 
notebooks.

```{r setup, message = FALSE}
library(tidyverse)
library(jsonlite)
library(caret)

report_theme <- ggplot2::theme_bw() +
  ggplot2::theme(panel.border = ggplot2::element_rect(color = "black",
                                                      fill = NA),
                 panel.grid.major = ggplot2::element_line(color = "black",
                                                          linetype = "dotted"),
                 panel.grid.minor = ggplot2::element_line(color = "black",
                                                          linetype = "dotted"))

lead_ref <- read_csv("lead_ref_data.csv", progress = FALSE)
```

# What variables correlate with booking?

My first step was to examine the data for obvious trends. Though no major 
trends popped out, one fairly useful trend appeared. I created an additional 
variable that gave whether a user left the website to a hotel partner that was 
the same as the referring hotel partner. This appeared to show that a much 
larger proportion of users booked a hotel when they left the site to a hotel 
of that same partner, as opposed to a different partner. 

```{r}
lead_ref %>% 
  mutate(same_partner = (partner_code_referral == rate_partner_lead)) %>% 
  filter(!is.na(same_partner)) %>% 
  ggplot(aes(x = same_partner, fill = booking_event)) +
  geom_bar() +
  coord_flip() +
  ggtitle("Count of Same Partner Events") +
  labs(y = "Count", 
       x = "Same Partner", 
       fill = "Booking Event")
```

```{r}
lead_ref %>% 
  mutate(same_partner = (partner_code_referral == rate_partner_lead)) %>% 
  filter(!is.na(same_partner)) %>% 
  ggplot(aes(x = same_partner, fill = booking_event)) +
  geom_bar(position = "fill") +
  coord_flip() +
  ggtitle("Proportion of Same Partner Events") +
  labs(y = "Proportion", 
       x = "Same Partner", 
       fill = "Booking Event")
```

My next step was to try calculating the correlation between the variables and 
the booking events. I found that for all of the numerical variables, the 
correlation was either incredibly small or non-existant. For the categorical 
variables I used a chi-square test that showed a high significance of 
variability, but gave little information on how those variables influenced 
the booking events.

To determine which variables had the greatest impact on booking, I decided to 
train a random forest model with the data and calculate the importance of the 
different variables to the model.

# Random Forest


